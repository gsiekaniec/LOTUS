#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import sys
sys.path.append('../')
import os
import logging
from pathlib import Path
import pytest
from python_scripts.filter import fail_filters, line_without_fail, get_values, create_new_records, tumor_sample_header_logging
from copy import deepcopy


###############################
# tumor sample header logging #
###############################

logger = logging.getLogger('This is not a logger')
line_no_tumor_sample = 'No tumor sample'
line_with_tumor_sample = '##tumor_sample=dark_vador_cell'

###############
# Fail filter #
###############

AD_ok_2 = [100,10,10]
AD_ok_1 = [100,10]
AD_nop_2 = [100,3,12]
AD_nop_1 = [100,2]

AF_ok_2 = [0.5,0.6]
AF_ok_1 = [0.5]
AF_nop_2 = [0.5,0.04]
AF_nop_1 = [0.03]


info_ok_2 = {'AS_FilterStatus': ['SITE|SITE'], 'AS_SB_TABLE': ['35', '0|15', '0|24', '1'], 'DP': 77, 'ECNT': 7, 'FUNCOTATION': ['[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]', '[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]'], 'GERMQ': 38, 'MBQ': [29, 34, 34], 'MFRL': [203, 212, 236], 'MMQ': [60, 60, 40], 'MPOS': [29, 24], 'POPAF': [7.3, 7.3], 'ROQ': 93.0, 'TLOD': [42.64, 88.66]}
info_ok_1 = {'AS_FilterStatus': ['SITE'], 'AS_SB_TABLE': ['0', '4|0', '1'], 'DP': 20, 'ECNT': 1, 'FUNCOTATION': ['[PLXNB3|hg38|chrX|153774047|153774047|MISSENSE||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|]'], 'GERMQ': 21, 'MBQ': [35, 21], 'MFRL': [355, 296], 'MMQ': [60, 60], 'MPOS': [41], 'POPAF': [7.3], 'ROQ': 25.0, 'TLOD': [3.02]}

DP_nop = {'AS_FilterStatus': ['SITE'], 'AS_SB_TABLE': ['0', '4|0', '1'], 'DP': 5, 'ECNT': 1, 'FUNCOTATION': ['[PLXNB3|hg38|chrX|153774047|153774047|MISSENSE||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|]'], 'GERMQ': 21, 'MBQ': [35, 21], 'MFRL': [355, 296], 'MMQ': [60, 60], 'MPOS': [41], 'POPAF': [7.3], 'ROQ': 25.0, 'TLOD': [3.02]}

silent_2 = {'AS_FilterStatus': ['SITE|SITE'], 'AS_SB_TABLE': ['35', '0|15', '0|24', '1'], 'DP': 77, 'ECNT': 7, 'FUNCOTATION': ['[LINC01410|hg38|chr9|62801195|62801195|SILENT||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]', '[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]'], 'GERMQ': 38, 'MBQ': [29, 34, 34], 'MFRL': [203, 212, 236], 'MMQ': [60, 60, 40], 'MPOS': [29, 24], 'POPAF': [7.3, 7.3], 'ROQ': 93.0, 'TLOD': [42.64, 88.66]}
silent_1 = {'AS_FilterStatus': ['SITE'], 'AS_SB_TABLE': ['0', '4|0', '1'], 'DP': 20, 'ECNT': 1, 'FUNCOTATION': ['[PLXNB3|hg38|chrX|153774047|153774047|SILENT||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|]'], 'GERMQ': 21, 'MBQ': [35, 21], 'MFRL': [355, 296], 'MMQ': [60, 60], 'MPOS': [41], 'POPAF': [7.3], 'ROQ': 25.0, 'TLOD': [3.02]}

MRFL_2 = {'AS_FilterStatus': ['SITE|SITE'], 'AS_SB_TABLE': ['35', '0|15', '0|24', '1'], 'DP': 77, 'ECNT': 7, 'FUNCOTATION': ['[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]', '[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]'], 'GERMQ': 38, 'MBQ': [29, 34, 34], 'MFRL': [203, 0, 236], 'MMQ': [60, 60, 40], 'MPOS': [29, 24], 'POPAF': [7.3, 7.3], 'ROQ': 93.0, 'TLOD': [42.64, 88.66]}
MRFL_1 = {'AS_FilterStatus': ['SITE'], 'AS_SB_TABLE': ['0', '4|0', '1'], 'DP': 20, 'ECNT': 1, 'FUNCOTATION': ['[PLXNB3|hg38|chrX|153774047|153774047|MISSENSE||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|]'], 'GERMQ': 21, 'MBQ': [35, 21], 'MFRL': [355, 0], 'MMQ': [60, 60], 'MPOS': [41], 'POPAF': [7.3], 'ROQ': 25.0, 'TLOD': [3.02]}

MBQ_2 = {'AS_FilterStatus': ['SITE|SITE'], 'AS_SB_TABLE': ['35', '0|15', '0|24', '1'], 'DP': 77, 'ECNT': 7, 'FUNCOTATION': ['[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]', '[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]'], 'GERMQ': 38, 'MBQ': [29, 34, 10], 'MFRL': [203, 212, 236], 'MMQ': [60, 60, 40], 'MPOS': [29, 24], 'POPAF': [7.3, 7.3], 'ROQ': 93.0, 'TLOD': [42.64, 88.66]}
MBQ_1 = {'AS_FilterStatus': ['SITE'], 'AS_SB_TABLE': ['0', '4|0', '1'], 'DP': 20, 'ECNT': 1, 'FUNCOTATION': ['[PLXNB3|hg38|chrX|153774047|153774047|MISSENSE||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|]'], 'GERMQ': 21, 'MBQ': [35, 10], 'MFRL': [355, 296], 'MMQ': [60, 10], 'MPOS': [41], 'POPAF': [7.3], 'ROQ': 25.0, 'TLOD': [3.02]}

POPAF_2 = {'AS_FilterStatus': ['SITE|SITE'], 'AS_SB_TABLE': ['35', '0|15', '0|24', '1'], 'DP': 77, 'ECNT': 7, 'FUNCOTATION': ['[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]', '[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||]'], 'GERMQ': 38, 'MBQ': [29, 34, 34], 'MFRL': [203, 212, 236], 'MMQ': [60, 60, 40], 'MPOS': [29, 24], 'POPAF': [7.3, 0.3], 'ROQ': 93.0, 'TLOD': [42.64, 88.66]}
POPAF_1 = {'AS_FilterStatus': ['SITE'], 'AS_SB_TABLE': ['0', '4|0', '1'], 'DP': 20, 'ECNT': 1, 'FUNCOTATION': ['[PLXNB3|hg38|chrX|153774047|153774047|MISSENSE||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|]'], 'GERMQ': 21, 'MBQ': [35, 21], 'MFRL': [355, 296], 'MMQ': [60, 60], 'MPOS': [41], 'POPAF': [0.3], 'ROQ': 25.0, 'TLOD': [3.02]}


#####################
# Line Without Fail #
#####################

complicated_case_record = ['chr9', '62801195', '.', 'G', 'A,T', '.', 'LOTUS_filter', 'AS_FilterStatus=SITE|SITE;AS_SB_TABLE=35,0|15,0|24,1;DP=77;ECNT=7;FUNCOTATION=[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||],[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||];GERMQ=38;MBQ=29,34,34;MFRL=203,212,236;MMQ=60,60,40;MPOS=29,24;POPAF=7.30,7.30;ROQ=93;TLOD=42.64,88.66;OTHER_FILTER=0:AF:AD,1:PASS', 'GT:AD:AF:DP:F1R2:F2R1:FAD:SB', '0/1/2:35,2,25:0.008,0.325:75:17,7,13:18,8,12:35,15,25:35,0,39,1'] 
case_not_ok_record = ['chr6', '143608388', '.', 'C', 'T', '.', 'LOTUS_filter', 'AS_FilterStatus=SITE;AS_SB_TABLE=5,11|16,43;DP=78;ECNT=1;FUNCOTATION=[LINC01410|hg38|chr9|39609857|39609857|SILENT||SNP|G|G|C|g.chr7:39609857G>C|ENST00000432096.2|+|3|505|c.492G>C|c.(490-492)cgG>cgC|p.R164R|0.6433915211970075|GCCACCGCCGGCGTTTCAGAC|AC004837.3_ENST00000420748.1_RNA/AC004837.1_ENST00000446267.1_RNA||||||||||||||||||||||||||||||||||CR457198|NM_001282446.1|NP_001269375||||||||||||||||||||||||||||||hg38|OREG1684300|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_YAE1D1_%7C_Gene_ID_%3D_ENSG00000241127_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_GATA2_%7C_Regulatory_Element_ID_%3D_ENST00000341105_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false|0.7372_%2C_._%2C_0.2628|false|false|1|false|true|true|YAE1D1:57002|true|false|false|true|true|false|false|false|false|false|false|false|false|false|false|false|false|false|false|true|4723885|39609857|false|false|0|true|0|true|0.71652013251783893_%2C_._%2C_0.28347986748216106|false|false|false|SNV|true|0x050100000305170136000100|1|false|111|rs4723885||1.96493e-01|5.26667e-01|5.19767e-01|5.35938e-01|2.41851e-01|2.42967e-01|2.40330e-01|1.44602e-01|1.46811e-01|1.42621e-01|1.27464e-01|1.26139e-01|1.00000e-01|1.00750e-01|1.28728e-01|1.33381e-01|2.07030e-01|1.48435e-01|1.58923e-01|1.37452e-01|1.87735e-01|1.90024e-01|2.05645e-01|1.71875e-01|1.89307e-01|1.90619e-01|1.91597e-01|1.87008e-01|1.91020e-01|1.85283e-01|1.85091e-01|1.82965e-01|1.87071e-01|5.26667e-01|1.75759e-01|1.36253e-01|1.38151e-01|1.35632e-01|rs4723885||2.66656e-01|5.17428e-01|5.13654e-01|5.20192e-01|2.27488e-01|2.00000e-01|2.53456e-01|1.37931e-01|1.12500e-01|1.47619e-01|1.24839e-01|1.28731e-01|1.22790e-01|2.63977e-01|1.66571e-01|1.73536e-01|1.58672e-01|2.68789e-01|1.73874e-01|1.59677e-01|1.77961e-01|1.70652e-01|1.84149e-01|1.65108e-01|1.32075e-01|1.69429e-01|1.69643e-01|1.69202e-01|5.17428e-01|2.66934e-01||7|39649456|false|false|rs4723885|];GERMQ=34;MBQ=24,32;MFRL=137,167;MMQ=60,60;MPOS=26;POPAF=4.31;ROQ=93;TLOD=174.37;OTHER_FILTER=0:NOT_FUNCTIONAL:AD', 'GT:AD:AF:DP:F1R2:F2R1:FAD:SB', '0/1:59,4:0.787:75:5,22:4,23:12,47:5,11,16,43']

to_suppr = {0}
intIndex = {'Chr': 0, 'Alt': 4, 'Filter': 6, 'Info': 7, 'Format': 8, 'Values': 9}
strLotusFilterCode = 'LOTUS_filter'
strFilterPassKey = 'OTHER_FILTER='
strFilterPassOk = 'PASS'


#############
# Get Value #
#############

complicated_record = ['chr9', '62801195', '.', 'G', 'A,T', '.', 'PASS', 'AS_FilterStatus=SITE|SITE;AS_SB_TABLE=35,0|15,0|24,1;DP=77;ECNT=7;FUNCOTATION=[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||],[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||];GERMQ=38;MBQ=29,34,34;MFRL=203,212,236;MMQ=60,60,40;MPOS=29,24;POPAF=7.30,7.30;ROQ=93;TLOD=42.64,88.66', 'GT:AD:AF:DP:F1R2:F2R1:FAD:SB', '0/1/2:35,2,25:0.008,0.325:75:17,7,13:18,8,12:35,15,25:35,0,39,1']
ok_record = ['chr6', '143507595', '.', 'C', 'A', '.', 'PASS', 'AS_FilterStatus=SITE;AS_SB_TABLE=0,4|0,1;DP=20;ECNT=1;FUNCOTATION=[PLXNB3|hg38|chrX|153774047|153774047|MISSENSE||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|];GERMQ=21;MBQ=35,21;MFRL=355,296;MMQ=60,60;MPOS=41;POPAF=7.30;ROQ=25;TLOD=3.02', 'GT:AD:AF:DP:F1R2:F2R1:FAD:SB', '0/1:10,7:0.286:5:2,1:2,0:4,1:0,4,0,1']
not_ok_record = ['chr6', '143608388', '.', 'C', 'T', '.', 'PASS', 'AS_FilterStatus=SITE;AS_SB_TABLE=5,11|16,43;DP=78;ECNT=1;FUNCOTATION=[LINC01410|hg38|chr9|39609857|39609857|SILENT||SNP|G|G|C|g.chr7:39609857G>C|ENST00000432096.2|+|3|505|c.492G>C|c.(490-492)cgG>cgC|p.R164R|0.6433915211970075|GCCACCGCCGGCGTTTCAGAC|AC004837.3_ENST00000420748.1_RNA/AC004837.1_ENST00000446267.1_RNA||||||||||||||||||||||||||||||||||CR457198|NM_001282446.1|NP_001269375||||||||||||||||||||||||||||||hg38|OREG1684300|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_YAE1D1_%7C_Gene_ID_%3D_ENSG00000241127_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_GATA2_%7C_Regulatory_Element_ID_%3D_ENST00000341105_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false|0.7372_%2C_._%2C_0.2628|false|false|1|false|true|true|YAE1D1:57002|true|false|false|true|true|false|false|false|false|false|false|false|false|false|false|false|false|false|false|true|4723885|39609857|false|false|0|true|0|true|0.71652013251783893_%2C_._%2C_0.28347986748216106|false|false|false|SNV|true|0x050100000305170136000100|1|false|111|rs4723885||1.96493e-01|5.26667e-01|5.19767e-01|5.35938e-01|2.41851e-01|2.42967e-01|2.40330e-01|1.44602e-01|1.46811e-01|1.42621e-01|1.27464e-01|1.26139e-01|1.00000e-01|1.00750e-01|1.28728e-01|1.33381e-01|2.07030e-01|1.48435e-01|1.58923e-01|1.37452e-01|1.87735e-01|1.90024e-01|2.05645e-01|1.71875e-01|1.89307e-01|1.90619e-01|1.91597e-01|1.87008e-01|1.91020e-01|1.85283e-01|1.85091e-01|1.82965e-01|1.87071e-01|5.26667e-01|1.75759e-01|1.36253e-01|1.38151e-01|1.35632e-01|rs4723885||2.66656e-01|5.17428e-01|5.13654e-01|5.20192e-01|2.27488e-01|2.00000e-01|2.53456e-01|1.37931e-01|1.12500e-01|1.47619e-01|1.24839e-01|1.28731e-01|1.22790e-01|2.63977e-01|1.66571e-01|1.73536e-01|1.58672e-01|2.68789e-01|1.73874e-01|1.59677e-01|1.77961e-01|1.70652e-01|1.84149e-01|1.65108e-01|1.32075e-01|1.69429e-01|1.69643e-01|1.69202e-01|5.17428e-01|2.66934e-01||7|39649456|false|false|rs4723885|];GERMQ=34;MBQ=24,32;MFRL=137,167;MMQ=60,60;MPOS=26;POPAF=4.31;ROQ=93;TLOD=174.37', 'GT:AD:AF:DP:F1R2:F2R1:FAD:SB', '0/1:59,4:0.787:75:5,22:4,23:12,47:5,11,16,43']

strFieldSplit = {1 : '\t', 'Info1' : ';', 'Info2' : '=', 'Funcota' : ',', 'Format1' : ':', 'Format2' : ','}
InfoFieldsToProcess = {'DP', 'MFRL', 'MBQ', 'POPAF', 'FUNCOTATION'}


######################
# Create New Records #
######################

strCRLF = '\n'
complicated_record2 = deepcopy(complicated_record)
ok_record2 = deepcopy(ok_record)
not_ok_record2 = deepcopy(not_ok_record)


################################################################################################################
################################################# Tests ########################################################
################################################################################################################

###############################
# tumor sample header logging #
###############################

def test_tumor_sample_header_ok():
	assert tumor_sample_header_logging(line_with_tumor_sample, logger)

def test_tumor_sample_header_not_ok():
        assert not tumor_sample_header_logging(line_no_tumor_sample, logger)


######################
# Create New Records #
######################

def test_create_new_complicated_records() :
	create_new_records(complicated_record2, strFieldSplit, intIndex, InfoFieldsToProcess, strCRLF) == (True, 'chr9       62801195        .       G       A,T     .       LOTUS_filter    AS_FilterStatus=SITE|SITE;AS_SB_TABLE=35,0|15,0|24,1;DP=77;ECNT=7;FUNCOTATION=[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||],[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||];GERMQ=38;MBQ=29,34,34;MFRL=203,212,236;MMQ=60,60,40;MPOS=29,24;POPAF=7.30,7.30;ROQ=93;TLOD=42.64,88.66;OTHER_FILTER=0:AD:AF,1:PASS  GT:AD:AF:DP:F1R2:F2R1:FAD:SB    0/1/2:35,2,25:0.008,0.325:75:17,7,13:18,8,12:35,15,25:35,0,39,1\n', 'chr9   62801195        .       G       T       .       PASS    AS_FilterStatus=SITE;AS_SB_TABLE=35,0|24,1;DP=77;ECNT=7;FUNCOTATION=[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||];GERMQ=38;MBQ=29,34;MFRL=203,236;MMQ=60,40;MPOS=24;POPAF=7.30;ROQ=93;TLOD=88.66;OTHER_FILTER=PASS GT:AD:AF:DP:F1R2:F2R1:FAD:SB    0/1:35/25:0.325:75:17/13:18/12:35/25:35,0,39,1\n')

def test_create_new_ok_records() :
	new_record = 'chr6   143507595       .       C       A       .       PASS    AS_FilterStatus=weak_evidence;AS_SB_TABLE=0,4|0,1;DP=20;ECNT=1;FUNCOTATION=[PLXNB3|hg38|chrX|153774047|153774047|MISSENSE||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|];GERMQ=21;MBQ=35,21;MFRL=355,296;MMQ=60,60;MPOS=41;POPAF=7.30;ROQ=25;TLOD=3.02;OTHER_FILTER=PASS    GT:AD:AF:DP:F1R2:F2R1:FAD:SB    0/1:10,7:0.286:5:2,1:2,0:4,1:0,4,0,1\n'
	create_new_records(ok_record2, strFieldSplit, intIndex, InfoFieldsToProcess, strCRLF) == (True, new_record, new_record)

def test_create_new_not_ok_records() :
	new_record = 'chr6   143608388       .       C       T       .       LOTUS_filter    AS_FilterStatus=SITE;AS_SB_TABLE=5,11|16,43;DP=78;ECNT=1;FUNCOTATION=[LINC01410|hg38|chr9|39609857|39609857|SILENT||SNP|G|G|C|g.chr7:39609857G>C|ENST00000432096.2|+|3|505|c.492G>C|c.(490-492)cgG>cgC|p.R164R|0.6433915211970075|GCCACCGCCGGCGTTTCAGAC|AC004837.3_ENST00000420748.1_RNA/AC004837.1_ENST00000446267.1_RNA||||||||||||||||||||||||||||||||||CR457198|NM_001282446.1|NP_001269375||||||||||||||||||||||||||||||hg38|OREG1684300|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_YAE1D1_%7C_Gene_ID_%3D_ENSG00000241127_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_GATA2_%7C_Regulatory_Element_ID_%3D_ENST00000341105_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false|0.7372_%2C_._%2C_0.2628|false|false|1|false|true|true|YAE1D1:57002|true|false|false|true|true|false|false|false|false|false|false|false|false|false|false|false|false|false|false|true|4723885|39609857|false|false|0|true|0|true|0.71652013251783893_%2C_._%2C_0.28347986748216106|false|false|false|SNV|true|0x050100000305170136000100|1|false|111|rs4723885||1.96493e-01|5.26667e-01|5.19767e-01|5.35938e-01|2.41851e-01|2.42967e-01|2.40330e-01|1.44602e-01|1.46811e-01|1.42621e-01|1.27464e-01|1.26139e-01|1.00000e-01|1.00750e-01|1.28728e-01|1.33381e-01|2.07030e-01|1.48435e-01|1.58923e-01|1.37452e-01|1.87735e-01|1.90024e-01|2.05645e-01|1.71875e-01|1.89307e-01|1.90619e-01|1.91597e-01|1.87008e-01|1.91020e-01|1.85283e-01|1.85091e-01|1.82965e-01|1.87071e-01|5.26667e-01|1.75759e-01|1.36253e-01|1.38151e-01|1.35632e-01|rs4723885||2.66656e-01|5.17428e-01|5.13654e-01|5.20192e-01|2.27488e-01|2.00000e-01|2.53456e-01|1.37931e-01|1.12500e-01|1.47619e-01|1.24839e-01|1.28731e-01|1.22790e-01|2.63977e-01|1.66571e-01|1.73536e-01|1.58672e-01|2.68789e-01|1.73874e-01|1.59677e-01|1.77961e-01|1.70652e-01|1.84149e-01|1.65108e-01|1.32075e-01|1.69429e-01|1.69643e-01|1.69202e-01|5.17428e-01|2.66934e-01||7|39649456|false|false|rs4723885|];GERMQ=34;MBQ=24,32;MFRL=137,167;MMQ=60,60;MPOS=26;POPAF=4.31;ROQ=93;TLOD=174.37;OTHER_FILTER=0:AD:NOT_FUNCTIONAL   GT:AD:AF:DP:F1R2:F2R1:FAD:SB    0/1:59,4:0.787:75:5,22:4,23:12,47:5,11,16,43\n'
	create_new_records(not_ok_record2, strFieldSplit, intIndex, InfoFieldsToProcess, strCRLF) == (False,  new_record, new_record)


#############
# Get Value #
#############

def test_get_value_complicated() :
	assert get_values (complicated_record, strFieldSplit, intIndex, InfoFieldsToProcess) == ({'AS_FilterStatus': 'SITE|SITE', 'AS_SB_TABLE': '35,0|15,0|24,1', 'DP': ['77'], 'ECNT': '7', 'FUNCOTATION': ['LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|A|g.chr9:62801195G>A|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||', 'LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||'], 'GERMQ': '38', 'MBQ': ['29', '34', '34'], 'MFRL': ['203', '212', '236'], 'MMQ': '60,60,40', 'MPOS': '29,24', 'POPAF': ['7.30', '7.30'], 'ROQ': '93', 'TLOD': '42.64,88.66'}, ['GT', 'AD', 'AF', 'DP', 'F1R2', 'F2R1', 'FAD', 'SB'], ['0/1/2', '35,2,25', '0.008,0.325', '75', '17,7,13', '18,8,12', '35,15,25', '35,0,39,1'], ['35', '2', '25'], ['0.008', '0.325'], False)

def test_get_value_ok() :
	 assert get_values (ok_record, strFieldSplit, intIndex, InfoFieldsToProcess) == ({'AS_FilterStatus': 'SITE', 'AS_SB_TABLE': '0,4|0,1', 'DP': ['20'], 'ECNT': '1', 'FUNCOTATION': ['PLXNB3|hg38|chrX|153774047|153774047|MISSENSE||SNP|G|G|C|g.chrX:153774047G>C|ENST00000361971.10|+|20|3589|c.3468G>C|c.(3466-3468)gaG>gaC|p.E1156D|0.683291770573566|TCAGCCGCGAGGGGCCTGCCC|PLXNB3_ENST00000538966.5_MISSENSE_p.E1179D/SRPK3_ENST00000489426.5_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||148|biliary_tract(2)_%7C_breast(11)_%7C_central_nervous_system(44)_%7C_haematopoietic_and_lymphoid_tissue(56)_%7C_large_intestine(11)_%7C_lung(2)_%7C_pancreas(22)||||U52111|NM_005393.2|NP_005384|HGNC:9105|plexin_%20_B3|Approved|gene_%20_with_%20_protein_%20_product|protein-coding_%20_gene|PLXN6||PLEXR_%2C__%20_PLEXB3||Xq28|2014-11-19|||AF149019||5365|ENSG00000198753|10520995||683|Plexins|CCDS14729_%2C__%20_CCDS55536|OTTHUMG00000024217|5365|300214|NM_001163257|Q9ULL4|ENSG00000198753|uc004fii.3||||PLXB3_HUMAN||B7Z3E6_%7C_F5H773_%7C_Q9HDA4|Q9ULL4|axon_%20_guidance_%20_(GO:0007411)_%7C_cell_%20_chemotaxis_%20_(GO:0060326)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_adhesion_%20_(GO:0007162)_%7C_negative_%20_regulation_%20_of_%20_cell_%20_migration_%20_(GO:0030336)_%7C_negative_%20_regulation_%20_of_%20_GTPase_%20_activity_%20_(GO:0034260)_%7C_negative_%20_regulation_%20_of_%20_lamellipodium_%20_assembly_%20_(GO:0010593)_%7C_positive_%20_chemotaxis_%20_(GO:0050918)_%7C_positive_%20_regulation_%20_of_%20_endothelial_%20_cell_%20_proliferation_%20_(GO:0001938)_%7C_semaphorin-plexin_%20_signaling_%20_pathway_%20_(GO:0071526)|integral_%20_component_%20_of_%20_membrane_%20_(GO:0016021)_%7C_intracellular_%20_(GO:0005622)_%7C_plasma_%20_membrane_%20_(GO:0005886)|protein_%20_domain_%20_specific_%20_binding_%20_(GO:0019904)_%7C_semaphorin_%20_receptor_%20_activity_%20_(GO:0017154)|true|false|0.2257_%2C_0.7743_%2C_.|false|false|1|false|true|true|PLXNB3:5365|true|false|false|true|true|false|false|false|false|false|false|true|false|false|false|false|false|false|false|true|6643791|153774047|false|false|0|true|0|false|0.24691004077471967_%2C_0.75307403160040774_%2C_0.00001592762487257|false|false|false|SNV|true|0x050100000a0517013e000100|1|false|116|rs6643791||7.81004e-01|6.67693e-01|6.68404e-01|6.65382e-01|8.18308e-01|8.14441e-01|8.30749e-01|6.98812e-01|6.92161e-01|7.16883e-01|7.40006e-01|7.33871e-01|8.54545e-01|7.77817e-01|7.53431e-01|7.28678e-01|7.77488e-01|7.65986e-01|7.65681e-01|7.66859e-01|7.88109e-01|7.93279e-01|7.24731e-01|7.57576e-01|7.91108e-01|7.97190e-01|8.00686e-01|7.84324e-01|7.56806e-01|8.09890e-01|7.92008e-01|7.91386e-01|7.93355e-01|8.19272e-01|7.72462e-01|8.19272e-01|8.35049e-01|8.05764e-01|rs6643791||7.58160e-01|6.75260e-01|6.76743e-01|6.72676e-01|8.08374e-01|8.11594e-01|8.01932e-01|7.41176e-01|7.00000e-01|7.77778e-01|7.70042e-01|7.61194e-01|7.81553e-01|7.59622e-01|7.70523e-01|7.69565e-01|7.72786e-01|7.55458e-01|7.96080e-01|7.69477e-01|7.98051e-01|7.92458e-01|8.12489e-01|7.91148e-01|7.12121e-01|7.71574e-01|7.74194e-01|7.65217e-01|8.08374e-01|7.54627e-01||X|153039502|false|false|rs6643791|'], 'GERMQ': '21', 'MBQ': ['35', '21'], 'MFRL': ['355', '296'], 'MMQ': '60,60', 'MPOS': '41', 'POPAF': ['7.30'], 'ROQ': '25', 'TLOD': '3.02'}, ['GT', 'AD', 'AF', 'DP', 'F1R2', 'F2R1', 'FAD', 'SB'], ['0/1', '10,7', '0.286', '5', '2,1', '2,0', '4,1', '0,4,0,1'], ['10', '7'], ['0.286'], False)	

def test_get_value_not_ok() :
	assert get_values (not_ok_record, strFieldSplit, intIndex, InfoFieldsToProcess) == ({'AS_FilterStatus': 'SITE', 'AS_SB_TABLE': '5,11|16,43', 'DP': ['78'], 'ECNT': '1', 'FUNCOTATION': ['LINC01410|hg38|chr9|39609857|39609857|SILENT||SNP|G|G|C|g.chr7:39609857G>C|ENST00000432096.2|+|3|505|c.492G>C|c.(490-492)cgG>cgC|p.R164R|0.6433915211970075|GCCACCGCCGGCGTTTCAGAC|AC004837.3_ENST00000420748.1_RNA/AC004837.1_ENST00000446267.1_RNA||||||||||||||||||||||||||||||||||CR457198|NM_001282446.1|NP_001269375||||||||||||||||||||||||||||||hg38|OREG1684300|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_YAE1D1_%7C_Gene_ID_%3D_ENSG00000241127_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_GATA2_%7C_Regulatory_Element_ID_%3D_ENST00000341105_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false|0.7372_%2C_._%2C_0.2628|false|false|1|false|true|true|YAE1D1:57002|true|false|false|true|true|false|false|false|false|false|false|false|false|false|false|false|false|false|false|true|4723885|39609857|false|false|0|true|0|true|0.71652013251783893_%2C_._%2C_0.28347986748216106|false|false|false|SNV|true|0x050100000305170136000100|1|false|111|rs4723885||1.96493e-01|5.26667e-01|5.19767e-01|5.35938e-01|2.41851e-01|2.42967e-01|2.40330e-01|1.44602e-01|1.46811e-01|1.42621e-01|1.27464e-01|1.26139e-01|1.00000e-01|1.00750e-01|1.28728e-01|1.33381e-01|2.07030e-01|1.48435e-01|1.58923e-01|1.37452e-01|1.87735e-01|1.90024e-01|2.05645e-01|1.71875e-01|1.89307e-01|1.90619e-01|1.91597e-01|1.87008e-01|1.91020e-01|1.85283e-01|1.85091e-01|1.82965e-01|1.87071e-01|5.26667e-01|1.75759e-01|1.36253e-01|1.38151e-01|1.35632e-01|rs4723885||2.66656e-01|5.17428e-01|5.13654e-01|5.20192e-01|2.27488e-01|2.00000e-01|2.53456e-01|1.37931e-01|1.12500e-01|1.47619e-01|1.24839e-01|1.28731e-01|1.22790e-01|2.63977e-01|1.66571e-01|1.73536e-01|1.58672e-01|2.68789e-01|1.73874e-01|1.59677e-01|1.77961e-01|1.70652e-01|1.84149e-01|1.65108e-01|1.32075e-01|1.69429e-01|1.69643e-01|1.69202e-01|5.17428e-01|2.66934e-01||7|39649456|false|false|rs4723885|'], 'GERMQ': '34', 'MBQ': ['24', '32'], 'MFRL': ['137', '167'], 'MMQ': '60,60', 'MPOS': '26', 'POPAF': ['4.31'], 'ROQ': '93', 'TLOD': '174.37'}, ['GT', 'AD', 'AF', 'DP', 'F1R2', 'F2R1', 'FAD', 'SB'], ['0/1', '59,4', '0.787', '75', '5,22', '4,23', '12,47', '5,11,16,43'], ['59', '4'], ['0.787'], False)


#####################
# Line Without Fail #
#####################

def test_line_without_fail_not_ok() :
	assert not line_without_fail(case_not_ok_record, to_suppr, intIndex, strLotusFilterCode, strFilterPassKey, strFilterPassOk)

def test_line_without_fail_complicated() :
	assert line_without_fail(complicated_case_record, to_suppr, intIndex, strLotusFilterCode, strFilterPassKey, strFilterPassOk)
	assert complicated_case_record == ['chr9', '62801195', '.', 'G', 'T', '.', 'PASS', 'AS_FilterStatus=SITE;AS_SB_TABLE=35,0|24,1;DP=77;ECNT=7;FUNCOTATION=[LINC01410|hg38|chr9|62801195|62801195|MISSENSE||SNP|G|G|T|g.chr9:62801195G>T|ENST00000424345.5|+||||||0.4937655860349127|TTGCTCACTCGGAGAGCTTGG|LINC01410_ENST00000659835.1_FIVE_PRIME_FLANK|||||||||||||||||||||||||||||||||||||HGNC:50702|long_%20_intergenic_%20_non-protein_%20_coding_%20_RNA_%20_1410|Approved|RNA_%2C__%20_long_%20_non-coding|non-coding_%20_RNA|||||9q13|2014-06-09|||CR627148|||ENSG00000238113||||||OTTHUMG00000013291|103352539||NR_121647||ENSG00000238113||hg38|OREG1510992|Type_%3D_TRANSCRIPTION_%20_FACTOR_%20_BINDING_%20_SITE_%7C_Gene_Symbol_%3D_RNA5SP283_%7C_Gene_ID_%3D_ENSG00000202474_%7C_Gene_Source_%3D_ENSEMBL_%7C_Regulatory_Element_Symbol_%3D_EGR1_%7C_Regulatory_Element_ID_%3D_ENST00000239938_%7C_Regulatory_Element_Source_%3D_ENSEMBL_%7C_PMID_%3D_18971253_%7C_Dataset_%3D_PAZAR||||||||true|false||false|false||false|false|false|LOC107987020:107987020_%7C_LINC01410:103352539|true|false|false|false|false|false|false|false|false|false|false|false|true|false|false|false|false|false|true|true|7040398|62801195|false|false|0|false|0|true|0.08218654434250764_%2C_0.41782938328236493_%2C_0.49998407237512742|false|false|false|SNV|false|0x050000020705000102000100|1|false|116|rs7040398|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||false|false||];GERMQ=38;MBQ=29,34;MFRL=203,236;MMQ=60,40;MPOS=24;POPAF=7.30;ROQ=93;TLOD=88.66;OTHER_FILTER=PASS', 'GT:AD:AF:DP:F1R2:F2R1:FAD:SB', '0/1:35/25:0.325:75:17/13:18/12:35/25:35,0,39,1']


###############
# Fail filter #
###############

def test_fail_filter_ok():
	assert not (fail_filters(info_ok_1, AD_ok_1, AF_ok_1, 1) and fail_filters(info_ok_2, AD_ok_2, AF_ok_2, 2))

def test_fail_filter_AD():
	assert fail_filters(info_ok_1, AD_nop_1, AF_ok_1, 1) and fail_filters(info_ok_2, AD_nop_2, AF_ok_2, 2)

def test_fail_filter_AF():
	assert fail_filters(info_ok_1, AD_ok_1, AF_nop_1, 1) and fail_filters(info_ok_2, AD_ok_2, AF_nop_2, 2)

def test_fail_filter_DP():
	assert fail_filters(DP_nop, AD_ok_1, AF_ok_1, 1)

def test_fail_filter_MBQ():
	assert fail_filters(MBQ_2, AD_ok_2, AF_ok_2, 2) #fail_filters(MBQ_1, AD_ok_1, AF_ok_1, 1)# and fail_filters(MBQ_2, AD_ok_2, AF_ok_2, 2)

def  test_fail_filter_POPAF():
	assert fail_filters(POPAF_1, AD_ok_1, AF_ok_1, 1) and fail_filters(POPAF_2, AD_ok_2, AF_ok_2, 2)

def  test_fail_filter_MRFL():
	assert fail_filters(MRFL_1, AD_ok_1, AF_ok_1, 1) and fail_filters(MRFL_2, AD_ok_2, AF_ok_2, 2)

def test_fail_filter_silent():
	assert fail_filters(silent_1, AD_ok_1, AF_ok_1, 1) and fail_filters(silent_2, AD_ok_2, AF_ok_2, 2)


